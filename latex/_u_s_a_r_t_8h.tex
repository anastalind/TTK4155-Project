\hypertarget{_u_s_a_r_t_8h}{}\section{Node2/\+U\+S\+A\+RT.h File Reference}
\label{_u_s_a_r_t_8h}\index{Node2/\+U\+S\+A\+R\+T.\+h@{Node2/\+U\+S\+A\+R\+T.\+h}}


Header-\/file for the U\+S\+A\+RT driver -\/ to initialize, recieve and transfer data.  


{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$avr/io.\+h$>$}\\*
{\ttfamily \#include $<$avr/interrupt.\+h$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include \char`\"{}bit\+\_\+operations.\+h\char`\"{}}\\*
Include dependency graph for U\+S\+A\+R\+T.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{_u_s_a_r_t_8h_a802b2b582b121e4632aa9a491d503720}{F\+O\+SC}~16000000
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_u_s_a_r_t_8h_a81d8695f4ff61065923f6618db3fd4f0}{U\+S\+A\+R\+T\+\_\+init} (unsigned int bd)
\item 
unsigned char \hyperlink{_u_s_a_r_t_8h_a8c45133eae96ef4a5ae6fb21111948ef}{U\+S\+A\+R\+T\+\_\+recv} (void)
\item 
void \hyperlink{_u_s_a_r_t_8h_a9fa0bb1ed5d9cfb9c7c9be2a7343cf49}{U\+S\+A\+R\+T\+\_\+trans} (unsigned char letter)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Header-\/file for the U\+S\+A\+RT driver -\/ to initialize, recieve and transfer data. 

\begin{DoxyAuthor}{Author}
\+: Anastasia LindbÃ¤ck and Marie Skatvedt 
\end{DoxyAuthor}


\subsection{Macro Definition Documentation}
\index{U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}!F\+O\+SC@{F\+O\+SC}}
\index{F\+O\+SC@{F\+O\+SC}!U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}}
\subsubsection[{\texorpdfstring{F\+O\+SC}{FOSC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+O\+SC~16000000}\hypertarget{_u_s_a_r_t_8h_a802b2b582b121e4632aa9a491d503720}{}\label{_u_s_a_r_t_8h_a802b2b582b121e4632aa9a491d503720}


Definition at line 16 of file U\+S\+A\+R\+T.\+h.



\subsection{Function Documentation}
\index{U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}!U\+S\+A\+R\+T\+\_\+init@{U\+S\+A\+R\+T\+\_\+init}}
\index{U\+S\+A\+R\+T\+\_\+init@{U\+S\+A\+R\+T\+\_\+init}!U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}}
\subsubsection[{\texorpdfstring{U\+S\+A\+R\+T\+\_\+init(unsigned int bd)}{USART_init(unsigned int bd)}}]{\setlength{\rightskip}{0pt plus 5cm}void U\+S\+A\+R\+T\+\_\+init (
\begin{DoxyParamCaption}
\item[{unsigned int}]{bd}
\end{DoxyParamCaption}
)}\hypertarget{_u_s_a_r_t_8h_a81d8695f4ff61065923f6618db3fd4f0}{}\label{_u_s_a_r_t_8h_a81d8695f4ff61065923f6618db3fd4f0}
Function for initializing U\+S\+A\+RT. 
\begin{DoxyParams}{Parameters}
{\em unsigned} & int bd -\/ bd register, User Baud Rate Register\\
\hline
\end{DoxyParams}
Function for initializing U\+S\+A\+RT. 
\begin{DoxyParams}{Parameters}
{\em unsigned} & int ubrr -\/ U\+B\+RR register, User Baud Rate Register \\
\hline
\end{DoxyParams}


Definition at line 11 of file U\+S\+A\+R\+T.\+c.


\begin{DoxyCode}
11                                   \{
12     \textcolor{comment}{// Check TXCn flag to check that transmitter has completed all transfers (BEFORE setting baud rate or
       frame format)}
13     \textcolor{comment}{//loop\_until\_bit\_is\_set(UCSR0A, TXC0);}
14 
15     \textcolor{comment}{// Check RXC flag to check that there is no unread data in the receive buffer (BEFORE setting baud rate
       or frame format)}
16     \textcolor{comment}{//loop\_until\_bit\_is\_set(UCSR0A, RXC0);}
17 
18     \textcolor{comment}{// Setting baud rate}
19     \textcolor{keywordtype}{int} ubrr = 0.15*((long)\hyperlink{_u_a_r_t_8h_a802b2b582b121e4632aa9a491d503720}{FOSC}/((\textcolor{keywordtype}{long})(16*bd))-1);
20 
21     UBRR0H = (\textcolor{keywordtype}{unsigned} char) (ubrr >> 8);
22     UBRR0L = (\textcolor{keywordtype}{unsigned} char) (ubrr);
23 
24     \textcolor{comment}{// Setting frame format}
25     \textcolor{comment}{//UCSR0C = (1<<USBS0) || (3<<UCSZ00);}
26 
27     \textcolor{comment}{// Enabling transmitter/receiver}
28     \hyperlink{_a_d_c_8h_aee5ffa3d123086ed1df972387522e4eb}{set\_bit}(UCSR0B, RXEN0);
29     \hyperlink{_a_d_c_8h_aee5ffa3d123086ed1df972387522e4eb}{set\_bit}(UCSR0B, TXEN0);
30 
31     fdevopen(\hyperlink{_u_s_a_r_t_8c_a9fa0bb1ed5d9cfb9c7c9be2a7343cf49}{USART\_trans}, \hyperlink{_u_s_a_r_t_8c_a8c45133eae96ef4a5ae6fb21111948ef}{USART\_recv});
32 
33 \}
\end{DoxyCode}
\index{U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}!U\+S\+A\+R\+T\+\_\+recv@{U\+S\+A\+R\+T\+\_\+recv}}
\index{U\+S\+A\+R\+T\+\_\+recv@{U\+S\+A\+R\+T\+\_\+recv}!U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}}
\subsubsection[{\texorpdfstring{U\+S\+A\+R\+T\+\_\+recv(void)}{USART_recv(void)}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned char U\+S\+A\+R\+T\+\_\+recv (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_u_s_a_r_t_8h_a8c45133eae96ef4a5ae6fb21111948ef}{}\label{_u_s_a_r_t_8h_a8c45133eae96ef4a5ae6fb21111948ef}
Function for recieving data from U\+S\+A\+RT. \begin{DoxyReturn}{Returns}
U\+D\+R0 -\/ Empty Handler, if register R\+X\+C0 (RX complete) is not set. 
\end{DoxyReturn}


Definition at line 38 of file U\+S\+A\+R\+T.\+c.


\begin{DoxyCode}
38                                 \{
39     \textcolor{comment}{// Wait for data to be received}
40     \hyperlink{_node1_2bit__operations_8h_adb35c737e10e9b80fe812de60da481a9}{loop\_until\_bit\_is\_set}(UCSR0A, RXC0);
41     
42     \textcolor{keywordflow}{return} UDRE0;
43 \}
\end{DoxyCode}
\index{U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}!U\+S\+A\+R\+T\+\_\+trans@{U\+S\+A\+R\+T\+\_\+trans}}
\index{U\+S\+A\+R\+T\+\_\+trans@{U\+S\+A\+R\+T\+\_\+trans}!U\+S\+A\+R\+T.\+h@{U\+S\+A\+R\+T.\+h}}
\subsubsection[{\texorpdfstring{U\+S\+A\+R\+T\+\_\+trans(unsigned char letter)}{USART_trans(unsigned char letter)}}]{\setlength{\rightskip}{0pt plus 5cm}void U\+S\+A\+R\+T\+\_\+trans (
\begin{DoxyParamCaption}
\item[{unsigned char}]{letter}
\end{DoxyParamCaption}
)}\hypertarget{_u_s_a_r_t_8h_a9fa0bb1ed5d9cfb9c7c9be2a7343cf49}{}\label{_u_s_a_r_t_8h_a9fa0bb1ed5d9cfb9c7c9be2a7343cf49}
Function for transferring data from U\+S\+A\+RT. 
\begin{DoxyParams}{Parameters}
{\em unsigned} & char letter -\/ Letter to be transferred \\
\hline
\end{DoxyParams}


Definition at line 48 of file U\+S\+A\+R\+T.\+c.


\begin{DoxyCode}
48                                         \{
49     \textcolor{comment}{// Wait for empty transmit buffer}
50     \hyperlink{_node1_2bit__operations_8h_adb35c737e10e9b80fe812de60da481a9}{loop\_until\_bit\_is\_set}(UCSR0A, UDRE0);
51     UDR0 = letter;
52 \}
\end{DoxyCode}
